<!doctype html>
<html lang="lv" data-bs-theme="auto">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
    <meta name="theme-color" content="#0e0f13" />
    <title>Latviešu valoda – Darbības Vārdi (B1)</title>
    <link rel="manifest" href="manifest.json" />
    <link rel="icon" href="favicon.ico" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.13.1/font/bootstrap-icons.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="assets/styles.css" />
    <script>
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('sw.js').catch(() => {});
      }
    </script>
  </head>
  <body>
    <nav class="navbar navbar-expand-lg bg-body-tertiary fixed-top border-bottom">
      <div class="container">
        <a class="navbar-brand d-flex align-items-center gap-2" href="index.html">
          <i class="bi bi-translate"></i> Latvian B1
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasNav" aria-controls="offcanvasNav" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasNav" aria-labelledby="offcanvasNavLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="offcanvasNavLabel">Menu</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body align-items-lg-center">
            <ul class="navbar-nav me-auto mb-2 mb-lg-0">
              <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
              <li class="nav-item"><a class="nav-link active" aria-current="page" href="darbibas-vards.html">Darbības Vārds</a></li>
              <li class="nav-item"><a class="nav-link" href="week1.html">Week 1</a></li>
            </ul>
            <div class="d-flex gap-2">
              <button id="themeToggle" class="btn btn-outline-secondary" type="button" aria-label="Toggle color mode">
                <i class="bi bi-moon-stars-fill d-none" id="iconDark"></i>
                <i class="bi bi-sun-fill" id="iconLight"></i>
              </button>
              <a class="btn btn-primary" href="https://github.com/oerbey/Latvian_Lang_B1" target="_blank" rel="noopener">
                <i class="bi bi-github"></i> <span class="ms-1 d-none d-sm-inline">GitHub</span>
              </a>
            </div>
          </div>
        </div>
      </div>
    </nav>

    <main class="container py-4 mt-5">
      <header class="mb-4">
        <div class="d-flex flex-column flex-md-row justify-content-between align-items-md-end gap-2">
          <div>
            <h1 class="h4 mb-1">Latviešu valoda – Darbības Vārdi (B1)</h1>
            <p class="mb-0">Sašauj latviešu vārdu ar tulkojumu. Strādā ar peli vai tastatūru.</p>
          </div>
          <div class="d-flex gap-2">
            <select id="language-select" class="form-select w-auto" aria-label="Language selection">
              <option value="eng">English</option>
              <option value="ru">Русский</option>
            </select>
            <select id="count-select" class="form-select w-auto" aria-label="Word count">
              <option value="6">6</option>
              <option value="8">8</option>
              <option value="10" selected>10</option>
              <option value="12">12</option>
            </select>
          </div>
        </div>
      </header>

      <section aria-labelledby="status-heading">
        <h2 id="status-heading" class="sr-only">Statuss</h2>
        <div id="score" class="status" aria-live="polite">Pareizi: 0 | Nepareizi: 0</div>
      </section>

      <section class="grid-words" aria-label="Vārdu saraksti">
        <div id="list-lv" role="listbox" aria-label="Latviešu vārdi"></div>
        <div id="list-tr" role="listbox" aria-label="Tulkojumi"></div>
      </section>

      <section class="mt-3">
        <button id="btn-new" class="btn btn-primary me-2">Jauna spēle</button>
        <button id="btn-speak" class="btn btn-secondary" aria-pressed="false">Ieslēgt izrunu</button>
      </section>

      <section aria-labelledby="help-heading" class="mt-3">
        <h2 id="help-heading" class="sr-only">Palīdzība</h2>
        <div id="help" aria-live="polite"></div>
      </section>
    </main>

    <footer class="border-top py-4 bg-body-tertiary">
      <div class="container d-flex flex-column flex-md-row justify-content-between align-items-center gap-3">
        <span class="text-secondary">© <span id="year"></span> Latvian B1 Games</span>
        <nav class="small">
          <a class="link-secondary me-3" href="index.html">Home</a>
          <a class="link-secondary me-3" href="darbibas-vards.html">Verbs</a>
          <a class="link-secondary" href="week1.html">Week 1</a>
        </nav>
      </div>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>
    <script src="assets/app.js" defer></script>
    <script src="theme.js"></script>
    <script>
      document.getElementById('year').textContent = new Date().getFullYear();
    </script>
    <script>
    /**
     * Anti-scroll-trap for mobile:
     * - Never cancel vertical swipes.
     * - Allow horizontal gestures (for sliders) to preventDefault.
     * - Runs on every element that can vertically scroll OR that might capture touches.
     */
    (function () {
      // Make sure the page itself is allowed to scroll
      document.documentElement.style.overflowY = 'auto';
      document.body.style.overflowY = 'auto';

      // If any ancestor wrongly sets touch-action:none, neutralize it up the chain of likely containers.
      const neutralizeTouchAction = (el) => {
        for (let n = el; n; n = n.parentElement) {
          const ta = getComputedStyle(n).touchAction;
          if (ta && ta.includes('none')) n.style.touchAction = 'auto';
        }
      };

      // Find likely scrollable containers (no hard-coded class names needed)
      const candidates = Array.from(document.querySelectorAll('*')).filter(el => {
        const cs = getComputedStyle(el);
        return /(auto|scroll)/.test(cs.overflowY) || /(auto|scroll)/.test(cs.overflow);
      });

      // Also include any big/fullscreen fixed elements that might eat touches
      const fullscreenFixed = Array.from(document.querySelectorAll('*')).filter(el => {
        const cs = getComputedStyle(el);
        if (cs.position !== 'fixed') return false;
        const r = el.getBoundingClientRect();
        return r.top <= 0 && r.left <= 0 &&
               r.right >= window.innerWidth && r.bottom >= window.innerHeight;
      });

      const targets = [...new Set([...candidates, ...fullscreenFixed])];
      if (targets.length === 0) return;

      targets.forEach(el => {
        // Encourage browsers (esp. iOS Safari) to treat vertical pan as the default
        el.style.webkitOverflowScrolling = 'touch';
        // Let vertical panning through; allow pinch-zoom
        if (!getComputedStyle(el).touchAction || getComputedStyle(el).touchAction === 'auto') {
          el.style.touchAction = 'pan-y pinch-zoom';
        }
        neutralizeTouchAction(el);

        let sx = 0, sy = 0;
        el.addEventListener('touchstart', (e) => {
          const t = e.touches[0];
          sx = t.clientX; sy = t.clientY;
        }, { passive: true });

        el.addEventListener('touchmove', (e) => {
          const t = e.touches[0];
          const dx = Math.abs(t.clientX - sx);
          const dy = Math.abs(t.clientY - sy);

          const isHorizontal = dx > dy;
          // Only suppress default for horizontal gestures (e.g., custom sliders).
          if (isHorizontal) {
            e.preventDefault(); // requires passive:false
          }
          // If the element itself cannot scroll vertically, let the event bubble so the page can scroll.
          // (Do NOT call preventDefault here.)
        }, { passive: false });
      });

      // Safety net: if the focused area still can't scroll and fills the screen exactly,
      // make sure there's ever-so-slight page scroll available to escape the trap.
      const root = document.scrollingElement || document.documentElement;
      if (root.scrollHeight <= root.clientHeight) {
        document.body.style.minHeight = 'calc(100dvh + 1px)';
      }
    })();
    </script>
  </body>
</html>

