  /* ===========================
     Global look & feel - RESPONSIVE
     =========================== */
  html,body{margin:0;padding:0;background:#0e0f13;color:#e9eef5;font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;overflow-x:hidden;}
  #wrap{max-width:980px;margin:0 auto;padding:12px;width:100%;box-sizing:border-box;}
  h1{font-weight:800;margin:8px 0 4px;font-size:clamp(18px,4vw,24px);}  
  #ui{display:flex;gap:8px;flex-wrap:wrap;margin:6px 0 10px;justify-content:center;}
  button{border:0;padding:8px 12px;border-radius:10px;background:#2a2f3a;color:#e9eef5;cursor:pointer;font-weight:700;font-size:clamp(12px,2.5vw,14px);touch-action:manipulation;min-height:44px;-webkit-user-select:none;user-select:none;}
  button:hover{filter:brightness(1.1)}
  button:active{transform:scale(0.98);}  
  button[disabled]{opacity:.4;cursor:not-allowed}
  .pill{background:#1c7ed6}
  .ghost{background:#3b3f4a}
  .ok{background:#2f9e44}
  .outline{background:transparent;border:2px solid #3b3f4a}
  .small{padding:6px 10px;font-size:clamp(10px,2vw,12px);border-radius:999px;min-height:36px;}
  .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, monospace;background:#111;border-radius:6px;padding:2px 6px}
  #canvas{display:block;width:100%;height:auto;border-radius:12px;background:linear-gradient(180deg,#12131a 0%,#12151c 100%);box-shadow:0 6px 30px rgba(0,0,0,.35);max-width:100%;transition:opacity 0.3s ease;}
  #canvas.loading{opacity:0.7;}
  #legend{font-size:clamp(11px,2.5vw,13px);opacity:.8;margin-top:6px;text-align:center;}
  a{color:#91c9ff}

  /* ===== New: top header badge ===== */
  #header{display:flex;align-items:center;justify-content:flex-start;margin:2px 0 6px;}
  .week-badge{display:inline-block;background:#1c7ed6;color:#fff;font-weight:800;padding:6px 12px;border-radius:999px;font-size:clamp(12px,2.5vw,14px);letter-spacing:.3px;box-shadow:0 2px 10px rgba(0,0,0,.25);}  

  /* Responsive canvas container */
  .canvas-container{position:relative;width:100%;max-width:980px;margin:0 auto;}

  /* Loading overlay */
  .loading-overlay{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#9fb3ff;font-size:14px;pointer-events:none;opacity:0;transition:opacity 0.3s ease;}
  .loading-overlay.visible{opacity:1;}

  /* Mobile-specific styles */
  @media (max-width: 768px) {
    #wrap{padding:8px;}
    h1{text-align:center;font-size:20px;}
    #header{justify-content:center;}
    #ui{gap:6px;justify-content:center;}
    button{padding:12px 10px;font-size:13px;min-width:60px;min-height:48px;} /* Larger touch targets */
    .small{padding:10px 8px;font-size:12px;min-height:44px;}
    #status{order:10;width:100%;text-align:center;margin-top:8px;margin-left:0!important;}
    /* Stack buttons on very small screens */
    #ui{flex-direction:row;align-items:center;}
  }
  
  @media (max-width: 480px) {
    #wrap{padding:6px;}
    h1{font-size:18px;}
    button{padding:10px 8px;font-size:12px;min-width:55px;min-height:46px;}
    #ui{gap:4px;flex-wrap:wrap;}
    /* Smaller buttons for tiny screens but still touch-friendly */
    .small{min-width:50px;padding:8px 6px;min-height:42px;}
  }
  
  @media (max-width: 360px) {
    button{padding:8px 6px;font-size:11px;min-width:50px;}
    .small{min-width:45px;padding:6px 4px;}
  }

  /* iOS Safari specific fixes */
  @supports (-webkit-touch-callout: none) {
    /* iOS Safari viewport fix */
    body {
      height: -webkit-fill-available;
    }
    
    /* Improve touch responsiveness on iOS */
    button, canvas {
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
    }
    
    /* Fix iOS Safari bounce scrolling */
    body {
      overflow: hidden;
      position: fixed;
      width: 100%;
    }
    
    #wrap {
      height: 100vh;
      height: -webkit-fill-available;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
  }

  /* High DPI displays (Retina, etc.) */
  @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    #canvas {
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
    }
  }

  /* Landscape orientation adjustments for mobile */
  @media (max-width: 768px) and (orientation: landscape) {
    h1 {
      font-size: 16px;
      margin: 4px 0 2px;
    }
    
    #ui {
      margin: 4px 0 6px;
    }
    
    button {
      padding: 8px 6px;
      min-height: 36px;
    }
    
    .small {
      padding: 6px 4px;
      min-height: 32px;
    }
  }

  /* Windows touch device optimizations */
  @media (pointer: coarse) {
    button {
      min-height: 44px; /* Windows touch guidelines */
    }
    
    .small {
      min-height: 36px;
    }
  }

