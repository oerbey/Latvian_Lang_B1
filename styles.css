@import url('https://fonts.googleapis.com/css2?family=Source+Sans+3:wght@400;500;600;700&family=Source+Serif+4:opsz,wght@8..60,400;8..60,600;8..60,700&display=swap');

:root {
  --bg: #f7f3ea;
  --surface: #ffffff;
  --surface-alt: rgba(255, 255, 255, 0.92);
  --surface-subtle: #f1ece3;
  --surface-subtle-strong: #e6dfd3;
  --border: #d8d0c4;
  --border-soft: #e2dbcf;
  --text: #1d1a16;
  --muted: #5d5a54;
  --accent: #2d4b73;
  --accent-hover: #244060;
  --accent-active: #1c334d;
  --accent-contrast: #fdfbf7;
  --accent-focus: rgba(45, 75, 115, 0.45);
  --accent-soft: rgba(45, 75, 115, 0.08);
  --accent-shadow: rgba(45, 75, 115, 0.18);
  --feedback-success: #1b6b5c;
  --feedback-error: #a23a32;
  --btn-disabled-bg: rgba(139, 129, 116, 0.2);
  --btn-disabled-fg: rgba(29, 26, 22, 0.55);
  --start-disabled-border: rgba(139, 129, 116, 0.4);
  --start-disabled-fg: rgba(139, 129, 116, 0.7);
  --restart-disabled-fg: rgba(139, 129, 116, 0.7);
  --choice-selected-bg: #e4dccf;
  --choice-hover-bg: #ebe4d7;
  --font-body: 'Source Sans 3', 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
  --font-display: 'Source Serif 4', 'Times New Roman', Times, serif;
  --shadow-soft: rgba(29, 26, 22, 0.12);
  --shadow-strong: rgba(29, 26, 22, 0.2);
  --radius-xl: 28px;
  --radius-lg: 20px;
  --radius-md: 14px;
  --bg-gradient: linear-gradient(180deg, #f7f3ea 0%, #efe6d9 100%);
  --bg-texture:
    radial-gradient(circle at 8% 12%, rgba(45, 75, 115, 0.08), transparent 45%),
    radial-gradient(circle at 86% 18%, rgba(163, 136, 94, 0.1), transparent 48%),
    radial-gradient(circle at 30% 80%, rgba(45, 75, 115, 0.06), transparent 50%);
  --bs-primary: var(--accent);
  --bs-primary-rgb: 45, 75, 115;
}

[data-bs-theme='dark'] {
  --bg: #0b0a09;
  --surface: #151312;
  --surface-alt: rgba(21, 19, 18, 0.92);
  --surface-subtle: rgba(32, 29, 27, 0.95);
  --surface-subtle-strong: rgba(44, 39, 36, 0.95);
  --border: #2d2926;
  --border-soft: rgba(185, 176, 165, 0.35);
  --text: #f3efe6;
  --muted: #d1c9bc;
  --accent: #7da6d9;
  --accent-hover: #6b95c7;
  --accent-active: #5a84b5;
  --accent-contrast: #101317;
  --accent-focus: rgba(125, 166, 217, 0.5);
  --accent-soft: rgba(125, 166, 217, 0.16);
  --accent-shadow: rgba(125, 166, 217, 0.2);
  --feedback-success: #3fb89f;
  --feedback-error: #e07a6a;
  --btn-disabled-bg: rgba(91, 84, 77, 0.55);
  --btn-disabled-fg: rgba(226, 219, 209, 0.7);
  --start-disabled-border: rgba(185, 176, 165, 0.28);
  --start-disabled-fg: rgba(185, 176, 165, 0.6);
  --restart-disabled-fg: rgba(185, 176, 165, 0.6);
  --choice-selected-bg: rgba(125, 166, 217, 0.22);
  --choice-hover-bg: rgba(44, 39, 36, 0.95);
  --shadow-soft: rgba(10, 9, 8, 0.45);
  --shadow-strong: rgba(10, 9, 8, 0.6);
  --bg-gradient: linear-gradient(180deg, #0b0a09 0%, #11100f 100%);
  --bg-texture:
    radial-gradient(circle at 10% 10%, rgba(125, 166, 217, 0.12), transparent 45%),
    radial-gradient(circle at 85% 15%, rgba(193, 165, 120, 0.12), transparent 50%);
  --bs-primary: var(--accent);
  --bs-primary-rgb: 125, 166, 217;
}

/* ===========================
     Global look & feel - RESPONSIVE
     =========================== */
html,
body {
  margin: 0;
  padding: 0;
  background-color: var(--bg);
  background-image: var(--bg-gradient), var(--bg-texture);
  background-repeat: no-repeat;
  background-size:
    cover,
    1200px 1200px;
  background-position:
    center,
    top left;
  color: var(--text);
  font-family: var(--font-body);
  overflow-x: hidden;
}
h1,
h2,
h3,
h4,
h5,
h6,
.display-1,
.display-2,
.display-3,
.display-4,
.display-5,
.display-6 {
  font-family: var(--font-display);
  letter-spacing: 0.01em;
}
h1 {
  font-weight: 800;
  margin: 8px 0 4px;
  font-size: clamp(18px, 4vw, 24px);
}

.week1-page #wrap {
  max-width: 1040px;
  margin: 0 auto;
  padding: clamp(1rem, 2vw, 1.5rem);
  width: 100%;
  box-sizing: border-box;
  border-radius: var(--radius-xl);
  border: 1px solid var(--border);
  background: linear-gradient(180deg, var(--surface) 0%, var(--surface-subtle) 100%);
  box-shadow: 0 28px 60px var(--shadow-soft);
}
.week1-page #ui {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
  margin: 6px 0 12px;
  justify-content: flex-start;
  align-items: center;
  padding: 0.6rem;
  border-radius: 16px;
  border: 1px solid var(--border);
  background: var(--surface);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.6);
}

.week1-page #status {
  padding: 0.3rem 0.75rem;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--surface-subtle);
  color: var(--text);
  font-size: 0.9rem;
}

.week1-page #language-select {
  border-radius: 12px;
  border: 1px solid var(--border);
  padding: 0.35rem 0.65rem;
  font-weight: 600;
  color: var(--text);
  background: var(--surface);
}

.week1-page button {
  border: 1px solid var(--border);
  padding: 8px 12px;
  border-radius: 12px;
  background: var(--surface);
  color: var(--text);
  cursor: pointer;
  font-weight: 700;
  font-size: clamp(12px, 2.5vw, 14px);
  touch-action: manipulation;
  min-height: 44px;
  -webkit-user-select: none;
  user-select: none;
  box-shadow: 0 8px 16px var(--shadow-soft);
  transition:
    transform 0.15s ease,
    box-shadow 0.15s ease,
    border-color 0.15s ease;
}
.week1-page button:hover:not([disabled]) {
  transform: translateY(-1px);
  border-color: var(--accent);
  box-shadow: 0 12px 22px var(--shadow-soft);
}
.week1-page button:active:not([disabled]) {
  transform: translateY(0);
}
.week1-page button[disabled] {
  opacity: 0.5;
  cursor: not-allowed;
  box-shadow: none;
}
.week1-page .pill {
  background: var(--accent);
  border-color: var(--accent);
  color: var(--accent-contrast);
  box-shadow: 0 12px 24px var(--accent-shadow);
}
.week1-page .ghost {
  background: var(--surface-subtle);
  color: var(--text);
}
.week1-page .ok {
  background: var(--feedback-success);
  border-color: var(--feedback-success);
  color: #ffffff;
}
.week1-page .outline {
  background: transparent;
  border: 1px solid var(--border);
  color: var(--muted);
}
.week1-page .small {
  padding: 6px 10px;
  font-size: clamp(10px, 2vw, 12px);
  border-radius: 999px;
  min-height: 36px;
}
.week1-page .kbd {
  font-family: ui-monospace, SFMono-Regular, Menlo, monospace;
  background: #111;
  border-radius: 6px;
  padding: 2px 6px;
  color: #f8fafc;
}
.sr-only,
.visually-hidden {
  position: absolute;
  width: 1px;
  height: 1px;
  padding: 0;
  margin: -1px;
  overflow: hidden;
  clip: rect(0 0 0 0);
  white-space: nowrap;
  border: 0;
}
.i18n-loading [data-i18n-key] {
  visibility: hidden;
}
.week1-page #canvas {
  display: block;
  width: 100%;
  height: auto;
  border-radius: 12px;
  background: linear-gradient(180deg, var(--surface-subtle) 0%, var(--surface-subtle-strong) 100%);
  border: 1px solid var(--border);
  box-shadow: 0 18px 36px var(--shadow-soft);
  max-width: 100%;
  transition: opacity 0.3s ease;
}
.week1-page #canvas.loading {
  opacity: 0.7;
}
.week1-page #legend {
  font-size: clamp(11px, 2.5vw, 13px);
  color: var(--muted);
  opacity: 0.9;
  margin-top: 6px;
  text-align: center;
}
a {
  color: var(--accent);
  text-decoration-color: color-mix(in srgb, var(--accent) 60%, transparent);
}

.skip-link {
  position: fixed;
  left: 50%;
  top: 0;
  padding: 0.65rem 1rem;
  border-radius: 999px;
  background: #0f172a;
  color: #ffffff;
  font-weight: 700;
  text-decoration: none;
  transform: translate(-50%, -180%);
  opacity: 0;
  pointer-events: none;
  transition:
    transform 0.2s ease,
    opacity 0.2s ease;
  box-shadow: 0 14px 28px rgba(15, 23, 42, 0.22);
  z-index: 1200;
}

.skip-link:focus,
.skip-link:focus-visible {
  transform: translate(-50%, 10px);
  opacity: 1;
  pointer-events: auto;
  outline: 3px solid var(--accent-focus);
  outline-offset: 2px;
}

/* ===== Week 1 header badge ===== */
.week1-page #header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 0.75rem;
  margin: 2px 0 10px;
}

.week1-page .week-badge {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  background: var(--accent);
  color: var(--accent-contrast);
  font-weight: 800;
  padding: 6px 12px;
  border-radius: 999px;
  font-size: clamp(12px, 2.5vw, 14px);
  letter-spacing: 0.3px;
  box-shadow: 0 10px 20px var(--accent-shadow);
}

/* Responsive canvas container */
.week1-page .canvas-container {
  position: relative;
  width: 100%;
  max-width: 980px;
  margin: 0 auto;
}

/* Loading overlay */
.week1-page .loading-overlay {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: var(--accent);
  font-weight: 600;
  font-size: 14px;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.3s ease;
}
.week1-page .loading-overlay.visible {
  opacity: 1;
}

/* Mobile-specific styles */
@media (max-width: 768px) {
  .week1-page #wrap {
    padding: 8px;
  }
  .week1-page h1 {
    text-align: center;
    font-size: 24px;
  }
  .week1-page #header {
    justify-content: center;
  }
  .week1-page #ui {
    gap: 6px;
    justify-content: center;
  }
  .week1-page button {
    padding: 14px 12px;
    font-size: 16px;
    min-width: 70px;
    min-height: 52px;
  } /* Larger touch targets */
  .week1-page .small {
    padding: 12px 10px;
    font-size: 14px;
    min-height: 48px;
  }
  .week1-page #legend {
    font-size: 14px;
  }
  .week1-page #status {
    order: 10;
    width: 100%;
    text-align: center;
    margin-top: 8px;
    margin-left: 0 !important;
  }
  /* Stack buttons on very small screens */
  .week1-page #ui {
    flex-direction: row;
    align-items: center;
  }
}

@media (max-width: 480px) {
  .week1-page #wrap {
    padding: 6px;
  }
  .week1-page h1 {
    font-size: 22px;
  }
  .week1-page button {
    padding: 12px 10px;
    font-size: 16px;
    min-width: 60px;
    min-height: 48px;
  }
  .week1-page #ui {
    gap: 6px;
    flex-wrap: wrap;
  }
  /* Smaller buttons for tiny screens but still touch-friendly */
  .week1-page .small {
    min-width: 55px;
    padding: 10px 8px;
    min-height: 48px;
    font-size: 14px;
  }
  .week1-page #legend {
    font-size: 13px;
  }
}

@media (max-width: 360px) {
  .week1-page button {
    padding: 10px 6px;
    font-size: 14px;
    min-width: 50px;
  }
  .week1-page .small {
    min-width: 45px;
    padding: 8px 4px;
    font-size: 12px;
  }
}

/* iOS Safari specific fixes */
@supports (-webkit-touch-callout: none) {
  /* iOS Safari viewport fix */
  body {
    height: -webkit-fill-available;
  }

  /* Improve touch responsiveness on iOS */
  button,
  canvas {
    -webkit-tap-highlight-color: transparent;
    -webkit-touch-callout: none;
    -webkit-user-select: none;
    user-select: none;
  }

  .week1-page #wrap {
    min-height: 100dvh;
    height: -webkit-fill-available;
    overflow-y: auto;
    -webkit-overflow-scrolling: touch;
  }
}

/* High DPI displays (Retina, etc.) */
@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
  .week1-page #canvas {
    image-rendering: -webkit-optimize-contrast;
    image-rendering: crisp-edges;
  }
}

/* Landscape orientation adjustments for mobile */
@media (max-width: 768px) and (orientation: landscape) {
  .week1-page h1 {
    font-size: 16px;
    margin: 4px 0 2px;
  }

  .week1-page #ui {
    margin: 4px 0 6px;
  }

  .week1-page button {
    padding: 8px 6px;
    min-height: 36px;
  }

  .week1-page .small {
    padding: 6px 4px;
    min-height: 32px;
  }
}

/* Windows touch device optimizations */
@media (pointer: coarse) {
  button,
  .btn,
  .btn-sm,
  .btn-lg,
  .nav-link,
  .navbar-toggler,
  .btn-close,
  .form-select,
  .form-control {
    min-height: 48px;
    min-width: 48px;
  }

  .small {
    min-height: 48px;
    min-width: 48px;
  }

  .nav-link {
    padding-top: 0.75rem;
    padding-bottom: 0.75rem;
  }
}

/* --- UI polish on top of Bootstrap --- */
html,
body {
  height: 100%;
  scroll-behavior: smooth;
}

.navbar-brand i {
  opacity: 0.85;
}

.hover-lift {
  transition:
    transform 0.2s ease,
    box-shadow 0.2s ease;
}
.hover-lift:hover {
  transform: translateY(-2px);
  box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
}

/* --- Loading overlay --- */
.llb1-loading-overlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  background: rgba(15, 23, 42, 0.45);
  z-index: 9998;
}

.llb1-loading-overlay[hidden] {
  display: none;
}

.llb1-loading-panel {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px 20px;
  min-width: 220px;
  border-radius: 16px;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--text);
  box-shadow: 0 16px 32px rgba(15, 23, 42, 0.2);
}

.llb1-loading-spinner {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  border: 3px solid rgba(148, 163, 184, 0.45);
  border-top-color: var(--accent);
  animation: llb1-spin 0.8s linear infinite;
}

.llb1-loading-message {
  font-weight: 600;
  letter-spacing: 0.01em;
}

@keyframes llb1-spin {
  to {
    transform: rotate(360deg);
  }
}

/* Color tweaks per mode (BS 5.3 color variables) */
:root,
[data-bs-theme='light'] {
  --brand-accent: #0d6efd;
}
[data-bs-theme='dark'] {
  --brand-accent: #66b2ff;
}

/* Home hub */
.home-main {
  position: relative;
}

.home-hero {
  position: relative;
  border-radius: var(--radius-xl);
  padding: clamp(1.5rem, 3vw, 2.75rem);
  background: linear-gradient(145deg, var(--surface) 0%, var(--surface-subtle) 100%);
  border: 1px solid var(--border);
  box-shadow: 0 30px 70px var(--shadow-soft);
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(min(320px, 100%), 1fr));
  gap: clamp(1.5rem, 3vw, 2.5rem);
  overflow: hidden;
  isolation: isolate;
}

.home-hero::after {
  content: '';
  position: absolute;
  inset: 0;
  background:
    radial-gradient(circle at 85% 15%, rgba(45, 75, 115, 0.18), transparent 55%),
    radial-gradient(circle at 15% 85%, rgba(163, 136, 94, 0.16), transparent 60%);
  opacity: 0.6;
  pointer-events: none;
  z-index: -1;
}

.home-hero__eyebrow {
  font-size: 0.85rem;
  letter-spacing: 0.18em;
  text-transform: uppercase;
  color: var(--muted);
  font-weight: 600;
  margin-bottom: 0.75rem;
}

.home-hero__title {
  font-size: clamp(2rem, 2.4vw + 1.4rem, 3rem);
  margin-bottom: 0.75rem;
}

.home-hero__lead {
  font-size: clamp(1rem, 0.9rem + 0.5vw, 1.25rem);
  color: var(--muted);
  max-width: 52ch;
  line-height: 1.6;
  margin-bottom: 1.5rem;
}

.home-hero__actions {
  display: flex;
  flex-wrap: wrap;
  gap: 0.75rem;
  align-items: center;
}

.home-hero__actions .btn {
  min-height: 48px;
  padding-inline: 1.2rem;
}

.home-hero__panel {
  display: flex;
  align-items: stretch;
}

.home-hero__tags {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
  margin-top: 1.5rem;
}

.home-tag {
  display: inline-flex;
  align-items: center;
  gap: 0.4rem;
  padding: 0.35rem 0.75rem;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--surface);
  font-size: 0.85rem;
  font-weight: 600;
  color: var(--text);
  box-shadow: 0 8px 18px rgba(29, 26, 22, 0.08);
}

.home-feature {
  position: relative;
  border-radius: var(--radius-lg);
  padding: 1.5rem;
  border: 1px solid var(--border);
  background: linear-gradient(180deg, var(--surface) 0%, var(--surface-subtle) 100%);
  box-shadow: 0 20px 45px var(--shadow-soft);
  display: grid;
  gap: 0.85rem;
}

.home-feature__label {
  font-size: 0.75rem;
  font-weight: 700;
  letter-spacing: 0.16em;
  text-transform: uppercase;
  color: var(--muted);
}

.home-feature__title {
  font-size: 1.4rem;
  margin: 0;
}

.home-feature__desc {
  color: var(--muted);
  margin: 0;
}

.home-feature__meta {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 0.65rem;
  font-size: 0.9rem;
  color: var(--text);
}

.home-feature__meta span {
  background: var(--surface);
  border: 1px solid var(--border);
  border-radius: 12px;
  padding: 0.45rem 0.6rem;
  font-weight: 600;
}

.home-feature__cta {
  justify-self: start;
}

.home-section {
  margin-top: clamp(2.5rem, 6vw, 4rem);
}

.home-section__header {
  display: flex;
  flex-direction: column;
  gap: 0.35rem;
  margin-bottom: 1.5rem;
}

.home-section__header h2 {
  font-size: clamp(1.5rem, 1.4rem + 1vw, 2.1rem);
  margin: 0;
}

.home-section__header p {
  color: var(--muted);
  margin: 0;
  max-width: 60ch;
}

.game-card {
  position: relative;
  display: flex;
  flex-direction: column;
  gap: 0.85rem;
  padding: 1.25rem;
  border-radius: var(--radius-lg);
  border: 1px solid var(--border);
  background: linear-gradient(160deg, var(--surface) 0%, var(--surface-subtle) 100%);
  color: var(--text);
  text-decoration: none;
  min-height: 100%;
  box-shadow: 0 18px 40px var(--shadow-soft);
  transition:
    transform 0.2s ease,
    box-shadow 0.2s ease,
    border-color 0.2s ease;
  overflow: hidden;
  animation: llb1-fade-up 0.6s ease both;
  animation-delay: var(--delay, 0ms);
}

.game-card__art {
  width: 100%;
  height: clamp(120px, 22vw, 160px);
  border-radius: 18px;
  border: 1px solid var(--border);
  background: var(--game-art, linear-gradient(135deg, #efe6d9, #f8f4ed));
  background-size: cover;
  background-position: center;
  display: grid;
  place-items: center;
  overflow: hidden;
  position: relative;
}

.game-card__art::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(255, 255, 255, 0) 0%, rgba(15, 23, 42, 0.08) 100%);
  pointer-events: none;
}

.game-card__art-icon {
  width: 48px;
  height: 48px;
  border-radius: 14px;
  display: grid;
  place-items: center;
  background: rgba(255, 255, 255, 0.78);
  border: 1px solid rgba(255, 255, 255, 0.8);
  box-shadow: 0 12px 24px rgba(15, 23, 42, 0.18);
  color: var(--game-accent, var(--accent));
  position: relative;
  z-index: 1;
}

.game-card::after {
  content: '';
  position: absolute;
  inset: 0;
  background: radial-gradient(
    circle at 90% 10%,
    var(--game-accent, var(--accent)) 0%,
    transparent 55%
  );
  opacity: 0.12;
  pointer-events: none;
}

.game-card:hover {
  transform: translateY(-4px);
  border-color: var(--game-accent, var(--accent));
  box-shadow: 0 24px 55px var(--shadow-strong);
}

.game-card:focus-visible {
  outline: 3px solid var(--accent-focus);
  outline-offset: 4px;
}

.game-card__top {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.75rem;
}

.game-card__label {
  font-size: 0.75rem;
  letter-spacing: 0.14em;
  text-transform: uppercase;
  font-weight: 700;
  color: var(--muted);
}

.game-card__icon {
  width: 42px;
  height: 42px;
  border-radius: 14px;
  display: grid;
  place-items: center;
  background: var(--surface);
  border: 1px solid var(--border);
  color: var(--game-accent, var(--accent));
}

.game-card__title {
  font-size: 1.25rem;
  margin: 0;
}

.game-card__desc {
  margin: 0;
  color: var(--muted);
  min-height: 3rem;
}

.game-card__meta {
  display: flex;
  flex-wrap: wrap;
  gap: 0.45rem;
}

.game-card__meta-item {
  padding: 0.3rem 0.6rem;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: var(--surface);
  font-size: 0.78rem;
  font-weight: 600;
  color: var(--text);
}

.game-card__cta {
  margin-top: auto;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: 0.35rem;
  padding: 0.5rem 0.9rem;
  border-radius: 999px;
  background: var(--game-accent, var(--accent));
  color: var(--accent-contrast);
  font-weight: 700;
  letter-spacing: 0.02em;
  width: fit-content;
  box-shadow: 0 10px 24px var(--accent-shadow);
}

@keyframes llb1-fade-up {
  from {
    opacity: 0;
    transform: translateY(12px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@media (prefers-reduced-motion: reduce) {
  .game-card,
  .hover-lift {
    animation: none !important;
    transition: none !important;
  }
}

/* Enable interaction for game choice buttons */
#game #choices .btn {
  pointer-events: auto;
  font-weight: 600;
}

/* Conjugation Sprint: better contrast in dark mode */
[data-bs-theme='dark'] #game #choices .btn.btn-outline-secondary {
  color: rgba(255, 255, 255, 0.92);
  border-color: rgba(255, 255, 255, 0.28);
}

/* Keep readable text in light mode */
[data-bs-theme='light'] #game #choices .btn.btn-outline-secondary {
  color: #212529;
}

/* Page must be scrollable unless you explicitly open a modal */
html,
body {
  min-height: 100%;
  overflow-y: auto;
  overscroll-behavior-y: auto; /* allow scroll chaining instead of trapping */
}

/* If you use full-screen sections, avoid a hard 100vh; use dynamic viewport units */
.section,
.page,
.screen {
  min-height: 100dvh;
}

/* Any hidden overlays/backdrops must not eat touches */
.is-hidden,
.hidden,
[aria-hidden='true'] {
  pointer-events: none !important;
}

/* Your list wrapper(s) should allow vertical panning */
.word-list,
.list,
.list-container,
.items,
[data-role='list'] {
  touch-action: pan-y;
  -webkit-overflow-scrolling: touch;
}

.llb1-sw-update {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 9999;
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  background: #0f172a;
  color: #f8fafc;
  border-radius: 999px;
  box-shadow: 0 12px 24px rgba(15, 23, 42, 0.25);
  font-size: 0.95rem;
}

.llb1-sw-update button {
  border: none;
  border-radius: 999px;
  padding: 6px 14px;
  min-height: 48px;
  min-width: 48px;
  background: #38bdf8;
  color: #0f172a;
  font-weight: 600;
  cursor: pointer;
}

.llb1-sw-update button:hover {
  background: #0ea5e9;
}

.llb1-offline {
  position: fixed;
  bottom: calc(20px + env(safe-area-inset-bottom, 0px));
  left: calc(20px + env(safe-area-inset-left, 0px));
  z-index: 9998;
  padding: 10px 14px;
  background: #b91c1c;
  color: #fff5f5;
  border-radius: 999px;
  font-size: 0.9rem;
  box-shadow: 0 12px 24px rgba(15, 23, 42, 0.2);
}

/* Reward toast */
.llb1-reward {
  position: fixed;
  left: 50%;
  bottom: calc(24px + env(safe-area-inset-bottom, 0px));
  transform: translateX(-50%) translateY(16px);
  opacity: 0;
  padding: 0.75rem 1rem;
  border-radius: 16px;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--text);
  box-shadow: 0 18px 40px var(--shadow-soft);
  z-index: 1200;
  min-width: min(320px, 92vw);
  max-width: min(420px, 92vw);
  display: grid;
  grid-template-columns: auto 1fr auto;
  gap: 0.75rem;
  align-items: center;
  text-align: left;
  transition:
    opacity 0.2s ease,
    transform 0.2s ease;
  pointer-events: none;
}

.llb1-reward.show {
  opacity: 1;
  transform: translateX(-50%) translateY(0);
}

.llb1-reward__icon {
  width: 36px;
  height: 36px;
  border-radius: 12px;
  display: grid;
  place-items: center;
  font-weight: 700;
  background: color-mix(in srgb, var(--reward-accent) 18%, var(--surface));
  color: var(--reward-accent);
}

.llb1-reward__content {
  display: grid;
  gap: 0.1rem;
}

.llb1-reward__title {
  font-weight: 700;
  font-size: 1rem;
}

.llb1-reward__detail {
  font-size: 0.9rem;
  color: var(--muted);
  margin-top: 0.2rem;
}

.llb1-reward__points {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  min-width: 54px;
  padding: 0.25rem 0.55rem;
  border-radius: 999px;
  border: 1px solid color-mix(in srgb, var(--reward-accent) 40%, transparent);
  color: var(--reward-accent);
  font-weight: 700;
  font-size: 0.85rem;
  background: color-mix(in srgb, var(--reward-accent) 12%, var(--surface));
}

.llb1-reward:not(.has-detail) .llb1-reward__detail {
  display: none;
}

.llb1-reward:not(.has-points) {
  grid-template-columns: auto 1fr;
}

.llb1-reward--success {
  --reward-accent: var(--feedback-success);
  border-color: var(--feedback-success);
}

.llb1-reward--accent {
  --reward-accent: var(--accent);
  border-color: var(--accent);
}

.llb1-reward--error {
  --reward-accent: var(--feedback-error);
  border-color: var(--feedback-error);
}

.llb1-reward::before,
.llb1-reward::after {
  content: '';
  position: absolute;
  width: 12px;
  height: 12px;
  border-radius: 50%;
  background: color-mix(in srgb, var(--reward-accent) 70%, transparent);
  opacity: 0;
  pointer-events: none;
}

.llb1-reward::before {
  top: -6px;
  left: 18px;
}

.llb1-reward::after {
  bottom: -6px;
  right: 18px;
}

.llb1-reward.show::before {
  animation: llb1-reward-spark 0.6s ease;
}

.llb1-reward.show::after {
  animation: llb1-reward-spark 0.6s ease 0.12s;
}

@keyframes llb1-reward-spark {
  0% {
    transform: scale(0.6);
    opacity: 0;
  }
  40% {
    opacity: 0.8;
  }
  100% {
    transform: scale(1.6);
    opacity: 0;
  }
}

@media (prefers-reduced-motion: reduce) {
  .llb1-reward,
  .llb1-reward.show {
    transition: none;
  }
  .llb1-reward::before,
  .llb1-reward::after {
    animation: none;
  }
}

/* ===========================
     Game theme skins
     =========================== */
body.game-theme {
  --accent: var(--game-accent);
  --accent-hover: var(--game-accent-hover);
  --accent-active: var(--game-accent-active);
  --accent-focus: var(--game-accent-focus);
  --accent-soft: var(--game-accent-soft);
  --accent-shadow: var(--game-accent-shadow);
  --bs-primary: var(--accent);
  --bs-primary-rgb: var(--game-accent-rgb);
  --bg-texture: var(--game-bg-texture);
  position: relative;
}

body.game-theme::before,
body.game-theme::after {
  content: '';
  position: fixed;
  pointer-events: none;
  z-index: 0;
}

body.game-theme::before {
  width: min(720px, 72vw);
  height: min(720px, 72vw);
  top: -180px;
  right: -200px;
  background-image: var(--game-motif);
  background-repeat: no-repeat;
  background-size: contain;
  opacity: var(--game-motif-opacity, 0.16);
  transform: rotate(-6deg);
}

body.game-theme::after {
  width: min(240px, 36vw);
  height: min(240px, 36vw);
  bottom: 6%;
  left: 6%;
  background-color: var(--game-icon-color, var(--game-accent));
  opacity: var(--game-icon-opacity, 0);
  mask-image: var(--game-icon-mask);
  mask-repeat: no-repeat;
  mask-size: contain;
  mask-position: center;
  -webkit-mask-image: var(--game-icon-mask);
  -webkit-mask-repeat: no-repeat;
  -webkit-mask-size: contain;
  -webkit-mask-position: center;
  filter: drop-shadow(0 20px 30px rgba(0, 0, 0, 0.12));
}

/* Keep decorative motifs behind core page layout without overriding overlay layers. */
body.game-theme > nav,
body.game-theme > main,
body.game-theme > footer {
  position: relative;
  z-index: 1;
}

@media (max-width: 900px) {
  body.game-theme::before {
    top: -140px;
    right: -160px;
  }
  body.game-theme::after {
    width: min(200px, 40vw);
    height: min(200px, 40vw);
    left: 4%;
    bottom: 4%;
  }
}

body.theme-darbibas {
  --game-accent: #2d4b73;
  --game-accent-hover: #254061;
  --game-accent-active: #1f3550;
  --game-accent-focus: rgba(45, 75, 115, 0.35);
  --game-accent-soft: rgba(45, 75, 115, 0.12);
  --game-accent-shadow: rgba(45, 75, 115, 0.22);
  --game-accent-rgb: 45, 75, 115;
  --game-bg-texture:
    radial-gradient(circle at 12% 18%, rgba(45, 75, 115, 0.16), transparent 45%),
    radial-gradient(circle at 82% 12%, rgba(163, 136, 94, 0.16), transparent 50%),
    radial-gradient(circle at 20% 82%, rgba(45, 75, 115, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 30% 30%, rgba(45, 75, 115, 0.28), transparent 60%),
    radial-gradient(circle at 80% 70%, rgba(163, 136, 94, 0.22), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Cpath%20d%3D%22M20%2030h38c8%200%2014%206%2014%2014v50c-5-7-11-11-22-11H20V30z%22%20fill%3D%22white%22%2F%3E%3Cpath%20d%3D%22M100%2030H62c-8%200-14%206-14%2014v50c5-7%2011-11%2022-11h30V30z%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body.theme-conjugation {
  --game-accent: #2b5f6f;
  --game-accent-hover: #235362;
  --game-accent-active: #1c4654;
  --game-accent-focus: rgba(43, 95, 111, 0.35);
  --game-accent-soft: rgba(43, 95, 111, 0.12);
  --game-accent-shadow: rgba(43, 95, 111, 0.2);
  --game-accent-rgb: 43, 95, 111;
  --game-bg-texture:
    radial-gradient(circle at 18% 12%, rgba(43, 95, 111, 0.16), transparent 45%),
    radial-gradient(circle at 80% 18%, rgba(114, 173, 185, 0.16), transparent 55%),
    radial-gradient(circle at 24% 78%, rgba(43, 95, 111, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 32% 28%, rgba(43, 95, 111, 0.3), transparent 60%),
    radial-gradient(circle at 82% 72%, rgba(114, 173, 185, 0.24), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Cpath%20d%3D%22M68%2010L34%2066h24l-12%2044%2040-64H62l6-36z%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body.theme-endings {
  --game-accent: #6a4b2e;
  --game-accent-hover: #5b3f26;
  --game-accent-active: #4a341f;
  --game-accent-focus: rgba(106, 75, 46, 0.35);
  --game-accent-soft: rgba(106, 75, 46, 0.12);
  --game-accent-shadow: rgba(106, 75, 46, 0.2);
  --game-accent-rgb: 106, 75, 46;
  --game-bg-texture:
    radial-gradient(circle at 16% 20%, rgba(106, 75, 46, 0.16), transparent 46%),
    radial-gradient(circle at 82% 16%, rgba(176, 142, 92, 0.16), transparent 55%),
    radial-gradient(circle at 22% 82%, rgba(106, 75, 46, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 26% 34%, rgba(106, 75, 46, 0.3), transparent 60%),
    radial-gradient(circle at 78% 74%, rgba(176, 142, 92, 0.24), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Crect%20x%3D%2218%22%20y%3D%2220%22%20width%3D%2236%22%20height%3D%2236%22%20rx%3D%226%22%20fill%3D%22white%22%2F%3E%3Crect%20x%3D%2266%22%20y%3D%2228%22%20width%3D%2236%22%20height%3D%2236%22%20rx%3D%226%22%20fill%3D%22white%22%2F%3E%3Crect%20x%3D%2236%22%20y%3D%2268%22%20width%3D%2248%22%20height%3D%2236%22%20rx%3D%226%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body.theme-passive {
  --game-accent: #3a516b;
  --game-accent-hover: #2f455d;
  --game-accent-active: #26394d;
  --game-accent-focus: rgba(58, 81, 107, 0.35);
  --game-accent-soft: rgba(58, 81, 107, 0.12);
  --game-accent-shadow: rgba(58, 81, 107, 0.2);
  --game-accent-rgb: 58, 81, 107;
  --game-bg-texture:
    radial-gradient(circle at 16% 16%, rgba(58, 81, 107, 0.16), transparent 46%),
    radial-gradient(circle at 82% 14%, rgba(127, 154, 182, 0.16), transparent 55%),
    radial-gradient(circle at 24% 80%, rgba(58, 81, 107, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 32% 28%, rgba(58, 81, 107, 0.3), transparent 60%),
    radial-gradient(circle at 78% 72%, rgba(127, 154, 182, 0.24), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Crect%20x%3D%2246%22%20y%3D%2210%22%20width%3D%2228%22%20height%3D%228%22%20rx%3D%223%22%20fill%3D%22white%22%2F%3E%3Cpath%20d%3D%22M50%2018h20v10l18%2030c6%2010-1%2024-13%2024H45c-12%200-19-14-13-24l18-30V18z%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body.theme-travel {
  --game-accent: #2f6b5b;
  --game-accent-hover: #285c4f;
  --game-accent-active: #204c40;
  --game-accent-focus: rgba(47, 107, 91, 0.35);
  --game-accent-soft: rgba(47, 107, 91, 0.12);
  --game-accent-shadow: rgba(47, 107, 91, 0.2);
  --game-accent-rgb: 47, 107, 91;
  --game-bg-texture:
    radial-gradient(circle at 16% 14%, rgba(47, 107, 91, 0.16), transparent 46%),
    radial-gradient(circle at 80% 16%, rgba(120, 182, 162, 0.16), transparent 55%),
    radial-gradient(circle at 24% 82%, rgba(47, 107, 91, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 30% 28%, rgba(47, 107, 91, 0.3), transparent 60%),
    radial-gradient(circle at 76% 74%, rgba(120, 182, 162, 0.24), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Cpath%20d%3D%22M60%2016c-16%200-28%2012-28%2028%200%2022%2028%2056%2028%2056s28-34%2028-56c0-16-12-28-28-28zm0%2038a10%2010%200%201%201%200-20%2010%2010%200%200%201%200%2020z%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body.theme-maini {
  --game-accent: #6a3b42;
  --game-accent-hover: #5b3239;
  --game-accent-active: #4b2930;
  --game-accent-focus: rgba(106, 59, 66, 0.35);
  --game-accent-soft: rgba(106, 59, 66, 0.12);
  --game-accent-shadow: rgba(106, 59, 66, 0.2);
  --game-accent-rgb: 106, 59, 66;
  --game-bg-texture:
    radial-gradient(circle at 16% 16%, rgba(106, 59, 66, 0.16), transparent 46%),
    radial-gradient(circle at 82% 14%, rgba(189, 125, 135, 0.16), transparent 55%),
    radial-gradient(circle at 24% 82%, rgba(106, 59, 66, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 28% 34%, rgba(106, 59, 66, 0.3), transparent 60%),
    radial-gradient(circle at 78% 70%, rgba(189, 125, 135, 0.24), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Cpath%20d%3D%22M24%2040h56l-10-10%208-8%2024%2024-24%2024-8-8%2010-10H24z%22%20fill%3D%22white%22%2F%3E%3Cpath%20d%3D%22M96%2080H40l10%2010-8%208-24-24%2024-24%208%208-10%2010h56z%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body.theme-duty {
  --game-accent: #4f4a7a;
  --game-accent-hover: #423d68;
  --game-accent-active: #373357;
  --game-accent-focus: rgba(79, 74, 122, 0.35);
  --game-accent-soft: rgba(79, 74, 122, 0.12);
  --game-accent-shadow: rgba(79, 74, 122, 0.2);
  --game-accent-rgb: 79, 74, 122;
  --game-bg-texture:
    radial-gradient(circle at 16% 18%, rgba(79, 74, 122, 0.16), transparent 46%),
    radial-gradient(circle at 82% 16%, rgba(145, 140, 195, 0.16), transparent 55%),
    radial-gradient(circle at 24% 82%, rgba(79, 74, 122, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 28% 32%, rgba(79, 74, 122, 0.3), transparent 60%),
    radial-gradient(circle at 78% 72%, rgba(145, 140, 195, 0.24), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Crect%20x%3D%2228%22%20y%3D%2224%22%20width%3D%2264%22%20height%3D%2280%22%20rx%3D%2210%22%20fill%3D%22white%22%2F%3E%3Crect%20x%3D%2244%22%20y%3D%2216%22%20width%3D%2232%22%20height%3D%2216%22%20rx%3D%226%22%20fill%3D%22white%22%2F%3E%3Crect%20x%3D%2242%22%20y%3D%2252%22%20width%3D%2236%22%20height%3D%228%22%20rx%3D%224%22%20fill%3D%22white%22%2F%3E%3Crect%20x%3D%2242%22%20y%3D%2268%22%20width%3D%2236%22%20height%3D%228%22%20rx%3D%224%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body.theme-decl6 {
  --game-accent: #5d3f2e;
  --game-accent-hover: #4f3526;
  --game-accent-active: #422c1f;
  --game-accent-focus: rgba(93, 63, 46, 0.35);
  --game-accent-soft: rgba(93, 63, 46, 0.12);
  --game-accent-shadow: rgba(93, 63, 46, 0.2);
  --game-accent-rgb: 93, 63, 46;
  --game-bg-texture:
    radial-gradient(circle at 16% 18%, rgba(93, 63, 46, 0.16), transparent 46%),
    radial-gradient(circle at 82% 14%, rgba(166, 129, 90, 0.16), transparent 55%),
    radial-gradient(circle at 24% 82%, rgba(93, 63, 46, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 28% 34%, rgba(93, 63, 46, 0.3), transparent 60%),
    radial-gradient(circle at 78% 70%, rgba(166, 129, 90, 0.24), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2224%22%20fill%3D%22white%22%2F%3E%3Crect%20x%3D%2266%22%20y%3D%2266%22%20width%3D%2236%22%20height%3D%2212%22%20rx%3D%226%22%20transform%3D%22rotate(45%2066%2066)%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body.theme-traits {
  --game-accent: #6b4f2f;
  --game-accent-hover: #5b4428;
  --game-accent-active: #4b3821;
  --game-accent-focus: rgba(107, 79, 47, 0.35);
  --game-accent-soft: rgba(107, 79, 47, 0.12);
  --game-accent-shadow: rgba(107, 79, 47, 0.2);
  --game-accent-rgb: 107, 79, 47;
  --game-bg-texture:
    radial-gradient(circle at 16% 18%, rgba(107, 79, 47, 0.16), transparent 46%),
    radial-gradient(circle at 82% 14%, rgba(176, 140, 89, 0.16), transparent 55%),
    radial-gradient(circle at 24% 82%, rgba(107, 79, 47, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 28% 34%, rgba(107, 79, 47, 0.3), transparent 60%),
    radial-gradient(circle at 78% 70%, rgba(176, 140, 89, 0.24), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Ccircle%20cx%3D%2260%22%20cy%3D%2244%22%20r%3D%2220%22%20fill%3D%22white%22%2F%3E%3Cpath%20d%3D%22M28%20104c6-22%2028-30%2032-30s26%208%2032%2030H28z%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body.theme-traits-match {
  --game-accent: #7a5b2b;
  --game-accent-hover: #6b4f25;
  --game-accent-active: #5a4120;
  --game-accent-focus: rgba(122, 91, 43, 0.35);
  --game-accent-soft: rgba(122, 91, 43, 0.12);
  --game-accent-shadow: rgba(122, 91, 43, 0.2);
  --game-accent-rgb: 122, 91, 43;
  --game-bg-texture:
    radial-gradient(circle at 16% 18%, rgba(122, 91, 43, 0.16), transparent 46%),
    radial-gradient(circle at 82% 16%, rgba(189, 152, 93, 0.16), transparent 55%),
    radial-gradient(circle at 24% 82%, rgba(122, 91, 43, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 28% 34%, rgba(122, 91, 43, 0.3), transparent 60%),
    radial-gradient(circle at 78% 70%, rgba(189, 152, 93, 0.24), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Crect%20x%3D%2220%22%20y%3D%2226%22%20width%3D%2248%22%20height%3D%2260%22%20rx%3D%2210%22%20fill%3D%22white%22%2F%3E%3Crect%20x%3D%2252%22%20y%3D%2234%22%20width%3D%2248%22%20height%3D%2260%22%20rx%3D%2210%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body.theme-traits-expansion {
  --game-accent: #6b4f2f;
  --game-accent-hover: #5b4428;
  --game-accent-active: #4b3821;
  --game-accent-focus: rgba(107, 79, 47, 0.35);
  --game-accent-soft: rgba(107, 79, 47, 0.12);
  --game-accent-shadow: rgba(107, 79, 47, 0.2);
  --game-accent-rgb: 107, 79, 47;
  --game-bg-texture:
    radial-gradient(circle at 16% 18%, rgba(107, 79, 47, 0.16), transparent 46%),
    radial-gradient(circle at 82% 14%, rgba(176, 140, 89, 0.16), transparent 55%),
    radial-gradient(circle at 24% 82%, rgba(107, 79, 47, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 28% 34%, rgba(107, 79, 47, 0.3), transparent 60%),
    radial-gradient(circle at 78% 70%, rgba(176, 140, 89, 0.24), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Cpath%20d%3D%22M20%2028h80a12%2012%200%200%201%2012%2012v36a12%2012%200%200%201-12%2012H58l-18%2016v-16H20A12%2012%200%200%201%208%2076V40a12%2012%200%200%201%2012-12z%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body.theme-week1 {
  --game-accent: #2f4c68;
  --game-accent-hover: #284258;
  --game-accent-active: #213748;
  --game-accent-focus: rgba(47, 76, 104, 0.35);
  --game-accent-soft: rgba(47, 76, 104, 0.12);
  --game-accent-shadow: rgba(47, 76, 104, 0.2);
  --game-accent-rgb: 47, 76, 104;
  --game-bg-texture:
    radial-gradient(circle at 16% 18%, rgba(47, 76, 104, 0.16), transparent 46%),
    radial-gradient(circle at 82% 16%, rgba(122, 160, 192, 0.16), transparent 55%),
    radial-gradient(circle at 24% 82%, rgba(47, 76, 104, 0.1), transparent 50%);
  --game-motif:
    radial-gradient(circle at 28% 34%, rgba(47, 76, 104, 0.3), transparent 60%),
    radial-gradient(circle at 78% 70%, rgba(122, 160, 192, 0.24), transparent 70%);
  --game-icon-mask: url('data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20viewBox%3D%220%200%20120%20120%22%3E%3Crect%20x%3D%2216%22%20y%3D%2224%22%20width%3D%2288%22%20height%3D%2272%22%20rx%3D%2212%22%20fill%3D%22white%22%2F%3E%3Crect%20x%3D%2216%22%20y%3D%2224%22%20width%3D%2288%22%20height%3D%2220%22%20rx%3D%2212%22%20fill%3D%22white%22%2F%3E%3Crect%20x%3D%2232%22%20y%3D%2212%22%20width%3D%2212%22%20height%3D%2220%22%20rx%3D%226%22%20fill%3D%22white%22%2F%3E%3Crect%20x%3D%2276%22%20y%3D%2212%22%20width%3D%2212%22%20height%3D%2220%22%20rx%3D%226%22%20fill%3D%22white%22%2F%3E%3C%2Fsvg%3E');
  --game-icon-opacity: 0.12;
}

body[data-bs-theme='dark'].theme-darbibas {
  --game-accent: #7da6d9;
  --game-accent-hover: #6b95c7;
  --game-accent-active: #5a84b5;
  --game-accent-focus: rgba(125, 166, 217, 0.5);
  --game-accent-soft: rgba(125, 166, 217, 0.2);
  --game-accent-shadow: rgba(125, 166, 217, 0.3);
  --game-accent-rgb: 125, 166, 217;
}

body[data-bs-theme='dark'].theme-conjugation {
  --game-accent: #79c3d4;
  --game-accent-hover: #67b2c3;
  --game-accent-active: #58a1b1;
  --game-accent-focus: rgba(121, 195, 212, 0.5);
  --game-accent-soft: rgba(121, 195, 212, 0.2);
  --game-accent-shadow: rgba(121, 195, 212, 0.3);
  --game-accent-rgb: 121, 195, 212;
}

body[data-bs-theme='dark'].theme-endings {
  --game-accent: #d3b48b;
  --game-accent-hover: #c2a67c;
  --game-accent-active: #b1976e;
  --game-accent-focus: rgba(211, 180, 139, 0.5);
  --game-accent-soft: rgba(211, 180, 139, 0.2);
  --game-accent-shadow: rgba(211, 180, 139, 0.3);
  --game-accent-rgb: 211, 180, 139;
}

body[data-bs-theme='dark'].theme-passive {
  --game-accent: #9bb6e4;
  --game-accent-hover: #8aa5d3;
  --game-accent-active: #7b95c2;
  --game-accent-focus: rgba(155, 182, 228, 0.5);
  --game-accent-soft: rgba(155, 182, 228, 0.2);
  --game-accent-shadow: rgba(155, 182, 228, 0.3);
  --game-accent-rgb: 155, 182, 228;
}

body[data-bs-theme='dark'].theme-travel {
  --game-accent: #7dcbb5;
  --game-accent-hover: #6bbba5;
  --game-accent-active: #5bab96;
  --game-accent-focus: rgba(125, 203, 181, 0.5);
  --game-accent-soft: rgba(125, 203, 181, 0.2);
  --game-accent-shadow: rgba(125, 203, 181, 0.3);
  --game-accent-rgb: 125, 203, 181;
}

body[data-bs-theme='dark'].theme-maini {
  --game-accent: #d38c97;
  --game-accent-hover: #c27c87;
  --game-accent-active: #b26d78;
  --game-accent-focus: rgba(211, 140, 151, 0.5);
  --game-accent-soft: rgba(211, 140, 151, 0.2);
  --game-accent-shadow: rgba(211, 140, 151, 0.3);
  --game-accent-rgb: 211, 140, 151;
}

body[data-bs-theme='dark'].theme-duty {
  --game-accent: #b2a9f0;
  --game-accent-hover: #a29ae1;
  --game-accent-active: #938bd2;
  --game-accent-focus: rgba(178, 169, 240, 0.5);
  --game-accent-soft: rgba(178, 169, 240, 0.2);
  --game-accent-shadow: rgba(178, 169, 240, 0.3);
  --game-accent-rgb: 178, 169, 240;
}

body[data-bs-theme='dark'].theme-decl6 {
  --game-accent: #c9a07a;
  --game-accent-hover: #b9936e;
  --game-accent-active: #a98662;
  --game-accent-focus: rgba(201, 160, 122, 0.5);
  --game-accent-soft: rgba(201, 160, 122, 0.2);
  --game-accent-shadow: rgba(201, 160, 122, 0.3);
  --game-accent-rgb: 201, 160, 122;
}

body[data-bs-theme='dark'].theme-traits {
  --game-accent: #d7b87e;
  --game-accent-hover: #c8aa71;
  --game-accent-active: #b99c64;
  --game-accent-focus: rgba(215, 184, 126, 0.5);
  --game-accent-soft: rgba(215, 184, 126, 0.2);
  --game-accent-shadow: rgba(215, 184, 126, 0.3);
  --game-accent-rgb: 215, 184, 126;
}

body[data-bs-theme='dark'].theme-traits-match {
  --game-accent: #e2c58d;
  --game-accent-hover: #d3b77f;
  --game-accent-active: #c5a972;
  --game-accent-focus: rgba(226, 197, 141, 0.5);
  --game-accent-soft: rgba(226, 197, 141, 0.2);
  --game-accent-shadow: rgba(226, 197, 141, 0.3);
  --game-accent-rgb: 226, 197, 141;
}

body[data-bs-theme='dark'].theme-traits-expansion {
  --game-accent: #d2b379;
  --game-accent-hover: #c4a56d;
  --game-accent-active: #b59761;
  --game-accent-focus: rgba(210, 179, 121, 0.5);
  --game-accent-soft: rgba(210, 179, 121, 0.2);
  --game-accent-shadow: rgba(210, 179, 121, 0.3);
  --game-accent-rgb: 210, 179, 121;
}

body[data-bs-theme='dark'].theme-week1 {
  --game-accent: #8fb5e0;
  --game-accent-hover: #7fa6cf;
  --game-accent-active: #7097bf;
  --game-accent-focus: rgba(143, 181, 224, 0.5);
  --game-accent-soft: rgba(143, 181, 224, 0.2);
  --game-accent-shadow: rgba(143, 181, 224, 0.3);
  --game-accent-rgb: 143, 181, 224;
}

/* ===========================
     Phase 6 UX refinements
     =========================== */
@keyframes llb1-focus-glow {
  0% {
    box-shadow: 0 0 0 0 color-mix(in srgb, var(--accent) 36%, transparent);
  }
  70% {
    box-shadow: 0 0 0 7px color-mix(in srgb, var(--accent) 0%, transparent);
  }
  100% {
    box-shadow: 0 0 0 0 color-mix(in srgb, var(--accent) 0%, transparent);
  }
}

@keyframes llb1-error-pulse {
  0%,
  100% {
    transform: translateY(0);
    text-shadow: 0 0 0 color-mix(in srgb, var(--feedback-error) 0%, transparent);
  }
  45% {
    transform: translateY(-1px);
    text-shadow: 0 0 12px color-mix(in srgb, var(--feedback-error) 35%, transparent);
  }
}

@keyframes llb1-cta-breathe {
  0%,
  100% {
    transform: translateY(0) scale(1);
  }
  50% {
    transform: translateY(-1px) scale(1.01);
  }
}

@keyframes llb1-enter-rise {
  from {
    opacity: 0;
    transform: translateY(8px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

body.game-theme {
  --llb1-motion-fast: 140ms;
  --llb1-motion-mid: 220ms;
}

body.game-theme main > * {
  animation: llb1-enter-rise 320ms ease both;
}

body.game-theme main > *:nth-child(2) {
  animation-delay: 45ms;
}

body.game-theme main > *:nth-child(3) {
  animation-delay: 90ms;
}

body.game-theme main > *:nth-child(4) {
  animation-delay: 130ms;
}

body.game-theme :where(button, .btn, [role='button']) {
  transition:
    transform var(--llb1-motion-fast) ease,
    box-shadow var(--llb1-motion-fast) ease,
    border-color var(--llb1-motion-fast) ease,
    background-color var(--llb1-motion-fast) ease,
    color var(--llb1-motion-fast) ease,
    opacity var(--llb1-motion-fast) ease;
}

body.game-theme
  :where(button, .btn, [role='button']):hover:not(:disabled):not([aria-disabled='true']) {
  transform: translateY(-1px);
}

body.game-theme
  :where(button, .btn, [role='button']):active:not(:disabled):not([aria-disabled='true']) {
  transform: translateY(0);
}

body.game-theme :where(button, .btn, [role='button'], a.btn):focus-visible {
  outline: 3px solid var(--accent-focus);
  outline-offset: 2px;
  animation: llb1-focus-glow 0.9s ease-out 1;
}

body.game-theme
  :where(input:not([type='checkbox']):not([type='radio']), textarea, select):focus-visible {
  outline: 3px solid var(--accent-focus);
  outline-offset: 2px;
  border-color: var(--accent);
  box-shadow: 0 0 0 0.2rem color-mix(in srgb, var(--accent) 20%, transparent);
  animation: llb1-focus-glow 0.9s ease-out 1;
}

body.game-theme :where(.btn-primary, [data-cta='primary'], .llb1-cta-primary) {
  box-shadow: 0 14px 28px var(--accent-shadow);
  animation: llb1-cta-breathe 2.8s ease-in-out infinite;
}

body.game-theme
  :where(.btn-primary, [data-cta='primary'], .llb1-cta-primary):hover:not(:disabled):not(
    [aria-disabled='true']
  ) {
  transform: translateY(-2px);
  box-shadow: 0 18px 34px var(--accent-shadow);
}

body.game-theme :where(.btn-outline-secondary, .btn-secondary, .btn-light) {
  opacity: 0.86;
  border-color: var(--border);
  background: color-mix(in srgb, var(--surface-subtle) 70%, transparent);
}

body.game-theme :where(.btn-outline-secondary, .btn-secondary, .btn-light):hover:not(:disabled) {
  opacity: 1;
}

body.game-theme :where(.is-invalid, [aria-invalid='true'], .eb-slot.is-wrong) {
  border-color: var(--feedback-error) !important;
  box-shadow: 0 0 0 0.2rem color-mix(in srgb, var(--feedback-error) 25%, transparent) !important;
}

body.game-theme
  :where(
    .text-danger,
    .text-danger-emphasis,
    .invalid-feedback,
    .decl6-option.incorrect,
    .dd-role.dd-role--wrong,
    .travel-panel__feedback.is-wrong,
    .passive-lab-hint
  ) {
  animation: llb1-error-pulse 0.9s ease-out 1;
}

@media (prefers-reduced-motion: reduce) {
  body.game-theme main > *,
  body.game-theme :where(button, .btn, [role='button']),
  body.game-theme :where(input, textarea, select),
  body.game-theme :where(.text-danger, .text-danger-emphasis, .invalid-feedback),
  body.game-theme :where(.btn-primary, [data-cta='primary'], .llb1-cta-primary) {
    animation: none !important;
    transition: none !important;
    transform: none !important;
  }
}
