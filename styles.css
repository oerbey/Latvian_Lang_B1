:root {
  --bg: #f4f7fb;
  --surface: #ffffff;
  --surface-alt: rgba(255, 255, 255, 0.92);
  --surface-subtle: #f1f5f9;
  --surface-subtle-strong: #e2e8f0;
  --border: #d0d7e2;
  --border-soft: #cbd5f5;
  --text: #0f172a;
  --muted: #475569;
  --accent: #2563eb;
  --accent-hover: #1d4ed8;
  --accent-active: #1a3fc4;
  --accent-contrast: #ffffff;
  --accent-focus: rgba(37, 99, 235, 0.45);
  --accent-soft: rgba(37, 99, 235, 0.08);
  --accent-shadow: rgba(37, 99, 235, 0.18);
  --feedback-success: #0f766e;
  --feedback-error: #b91c1c;
  --btn-disabled-bg: rgba(148, 163, 184, 0.28);
  --btn-disabled-fg: rgba(15, 23, 42, 0.55);
  --start-disabled-border: rgba(148, 163, 184, 0.45);
  --start-disabled-fg: rgba(148, 163, 184, 0.7);
  --restart-disabled-fg: rgba(148, 163, 184, 0.7);
  --choice-selected-bg: #e2e8f0;
  --choice-hover-bg: #e2e8f0;
}

[data-bs-theme="dark"] {
  --bg: #05060a;
  --surface: #0f172a;
  --surface-alt: rgba(15, 23, 42, 0.88);
  --surface-subtle: rgba(30, 41, 59, 0.95);
  --surface-subtle-strong: rgba(51, 65, 85, 0.95);
  --border: #1f2937;
  --border-soft: rgba(148, 163, 184, 0.45);
  --text: #f8fafc;
  --muted: #cbd5f5;
  --accent: #60a5fa;
  --accent-hover: #3b82f6;
  --accent-active: #2563eb;
  --accent-contrast: #04111f;
  --accent-focus: rgba(147, 197, 253, 0.6);
  --accent-soft: rgba(96, 165, 250, 0.16);
  --accent-shadow: rgba(96, 165, 250, 0.2);
  --feedback-success: #34d399;
  --feedback-error: #f87171;
  --btn-disabled-bg: rgba(71, 85, 105, 0.55);
  --btn-disabled-fg: rgba(226, 232, 240, 0.7);
  --start-disabled-border: rgba(148, 163, 184, 0.3);
  --start-disabled-fg: rgba(148, 163, 184, 0.6);
  --restart-disabled-fg: rgba(148, 163, 184, 0.6);
  --choice-selected-bg: rgba(37, 99, 235, 0.2);
  --choice-hover-bg: rgba(51, 65, 85, 0.95);
}

  /* ===========================
     Global look & feel - RESPONSIVE
     =========================== */
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;overflow-x:hidden;}
  #wrap{max-width:980px;margin:0 auto;padding:12px;width:100%;box-sizing:border-box;}
  h1{font-weight:800;margin:8px 0 4px;font-size:clamp(18px,4vw,24px);}  
  #ui{display:flex;gap:8px;flex-wrap:wrap;margin:6px 0 10px;justify-content:center;}
  button{border:0;padding:8px 12px;border-radius:10px;background:#2a2f3a;color:#e9eef5;cursor:pointer;font-weight:700;font-size:clamp(12px,2.5vw,14px);touch-action:manipulation;min-height:44px;-webkit-user-select:none;user-select:none;}
  button:hover{filter:brightness(1.1)}
  button:active{transform:scale(0.98);}  
  button[disabled]{opacity:.4;cursor:not-allowed}
  .pill{background:#1c7ed6}
  .ghost{background:#3b3f4a}
  .ok{background:#2f9e44}
  .outline{background:transparent;border:2px solid #3b3f4a}
  .small{padding:6px 10px;font-size:clamp(10px,2vw,12px);border-radius:999px;min-height:36px;}
  .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, monospace;background:#111;border-radius:6px;padding:2px 6px}
  .sr-only,.visually-hidden{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0 0 0 0);white-space:nowrap;border:0}
  #canvas{display:block;width:100%;height:auto;border-radius:12px;background:linear-gradient(180deg,#12131a 0%,#12151c 100%);box-shadow:0 6px 30px rgba(0,0,0,.35);max-width:100%;transition:opacity 0.3s ease;}
  #canvas.loading{opacity:0.7;}
  #legend{font-size:clamp(11px,2.5vw,13px);opacity:.8;margin-top:6px;text-align:center;}
  a{color:#91c9ff}

  .skip-link{
    position: absolute;
    left: 12px;
    top: 8px;
    padding: 10px 14px;
    border-radius: 999px;
    background: #0f172a;
    color: #ffffff;
    font-weight: 700;
    text-decoration: none;
    transform: translateY(-120%);
    transition: transform 0.2s ease;
    z-index: 1100;
  }

  .skip-link:focus,
  .skip-link:focus-visible{
    transform: translateY(0);
    outline: 3px solid var(--accent-focus);
    outline-offset: 2px;
  }

  /* ===== New: top header badge ===== */
  #header{display:flex;align-items:center;justify-content:flex-start;margin:2px 0 6px;}
  .week-badge{display:inline-block;background:#1c7ed6;color:#fff;font-weight:800;padding:6px 12px;border-radius:999px;font-size:clamp(12px,2.5vw,14px);letter-spacing:.3px;box-shadow:0 2px 10px rgba(0,0,0,.25);}  

  /* Responsive canvas container */
  .canvas-container{position:relative;width:100%;max-width:980px;margin:0 auto;}

  /* Loading overlay */
  .loading-overlay{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#9fb3ff;font-size:14px;pointer-events:none;opacity:0;transition:opacity 0.3s ease;}
  .loading-overlay.visible{opacity:1;}

  /* Mobile-specific styles */
  @media (max-width: 768px) {
    #wrap{padding:8px;}
    h1{text-align:center;font-size:24px;}
    #header{justify-content:center;}
    #ui{gap:6px;justify-content:center;}
    button{padding:14px 12px;font-size:16px;min-width:70px;min-height:52px;} /* Larger touch targets */
    .small{padding:12px 10px;font-size:14px;min-height:48px;}
    #legend{font-size:14px;}
    #status{order:10;width:100%;text-align:center;margin-top:8px;margin-left:0!important;}
    /* Stack buttons on very small screens */
    #ui{flex-direction:row;align-items:center;}
  }

  @media (max-width: 480px) {
    #wrap{padding:6px;}
    h1{font-size:22px;}
    button{padding:12px 10px;font-size:16px;min-width:60px;min-height:48px;}
    #ui{gap:6px;flex-wrap:wrap;}
    /* Smaller buttons for tiny screens but still touch-friendly */
    .small{min-width:55px;padding:10px 8px;min-height:48px;font-size:14px;}
    #legend{font-size:13px;}
  }

  @media (max-width: 360px) {
    button{padding:10px 6px;font-size:14px;min-width:50px;}
    .small{min-width:45px;padding:8px 4px;font-size:12px;}
  }

  /* iOS Safari specific fixes */
  @supports (-webkit-touch-callout: none) {
    /* iOS Safari viewport fix */
    body {
      height: -webkit-fill-available;
    }
    
    /* Improve touch responsiveness on iOS */
    button, canvas {
      -webkit-tap-highlight-color: transparent;
      -webkit-touch-callout: none;
      -webkit-user-select: none;
      user-select: none;
    }
    
      #wrap {
        min-height: 100dvh;
        height: -webkit-fill-available;
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }
  }

  /* High DPI displays (Retina, etc.) */
  @media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {
    #canvas {
      image-rendering: -webkit-optimize-contrast;
      image-rendering: crisp-edges;
    }
  }

  /* Landscape orientation adjustments for mobile */
  @media (max-width: 768px) and (orientation: landscape) {
    h1 {
      font-size: 16px;
      margin: 4px 0 2px;
    }
    
    #ui {
      margin: 4px 0 6px;
    }
    
    button {
      padding: 8px 6px;
      min-height: 36px;
    }
    
    .small {
      padding: 6px 4px;
      min-height: 32px;
    }
  }

  /* Windows touch device optimizations */
  @media (pointer: coarse) {
    button,
    .btn,
    .btn-sm,
    .btn-lg,
    .nav-link,
    .navbar-toggler,
    .btn-close,
    .form-select,
    .form-control {
      min-height: 48px;
      min-width: 48px;
    }

    .small {
      min-height: 48px;
      min-width: 48px;
    }

    .nav-link {
      padding-top: 0.75rem;
      padding-bottom: 0.75rem;
    }
  }


/* --- UI polish on top of Bootstrap --- */
html, body { height: 100%; scroll-behavior: smooth; }

.navbar-brand i { opacity: 0.85; }

.hover-lift { transition: transform .2s ease, box-shadow .2s ease; }
.hover-lift:hover {
  transform: translateY(-2px);
  box-shadow: 0 .5rem 1rem rgba(0,0,0,.15);
}

/* --- Loading overlay --- */
.llb1-loading-overlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 24px;
  background: rgba(15, 23, 42, 0.45);
  z-index: 9998;
}

.llb1-loading-overlay[hidden] {
  display: none;
}

.llb1-loading-panel {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 16px 20px;
  min-width: 220px;
  border-radius: 16px;
  border: 1px solid var(--border);
  background: var(--surface);
  color: var(--text);
  box-shadow: 0 16px 32px rgba(15, 23, 42, 0.2);
}

.llb1-loading-spinner {
  width: 22px;
  height: 22px;
  border-radius: 50%;
  border: 3px solid rgba(148, 163, 184, 0.45);
  border-top-color: var(--accent);
  animation: llb1-spin 0.8s linear infinite;
}

.llb1-loading-message {
  font-weight: 600;
  letter-spacing: 0.01em;
}

@keyframes llb1-spin {
  to {
    transform: rotate(360deg);
  }
}

/* Color tweaks per mode (BS 5.3 color variables) */
:root, [data-bs-theme="light"] { --brand-accent: #0d6efd; }
[data-bs-theme="dark"] { --brand-accent: #66b2ff; }

  /* Card spacing harmony */
  #gamesGrid .card .btn { pointer-events: none; } /* button-like label without stealing click */
  #gamesGrid a .card { border: 1px solid var(--bs-border-color); }

  /* Enable interaction for game choice buttons */
  #game #choices .btn { pointer-events: auto; font-weight: 600; }

/* Conjugation Sprint: better contrast in dark mode */
[data-bs-theme="dark"] #game #choices .btn.btn-outline-secondary {
  color: rgba(255,255,255,.92);
  border-color: rgba(255,255,255,.28);
}

/* Keep readable text in light mode */
[data-bs-theme="light"] #game #choices .btn.btn-outline-secondary {
  color: #212529;
}

/* Page must be scrollable unless you explicitly open a modal */
html, body {
  min-height: 100%;
  overflow-y: auto;
  overscroll-behavior-y: auto; /* allow scroll chaining instead of trapping */
}

/* If you use full-screen sections, avoid a hard 100vh; use dynamic viewport units */
.section,
.page,
.screen {
  min-height: 100dvh;
}

/* Any hidden overlays/backdrops must not eat touches */
.is-hidden,
.hidden,
[aria-hidden="true"] {
  pointer-events: none !important;
}

/* Your list wrapper(s) should allow vertical panning */
.word-list, .list, .list-container, .items, [data-role="list"] {
  touch-action: pan-y;
  -webkit-overflow-scrolling: touch;
}

.llb1-sw-update {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 9999;
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  background: #0f172a;
  color: #f8fafc;
  border-radius: 999px;
  box-shadow: 0 12px 24px rgba(15, 23, 42, 0.25);
  font-size: 0.95rem;
}

.llb1-sw-update button {
  border: none;
  border-radius: 999px;
  padding: 6px 14px;
  min-height: 48px;
  min-width: 48px;
  background: #38bdf8;
  color: #0f172a;
  font-weight: 600;
  cursor: pointer;
}

.llb1-sw-update button:hover {
  background: #0ea5e9;
}
